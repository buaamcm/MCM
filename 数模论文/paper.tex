% -*- coding: utf-8 -*-
%%
%%  本模板可以使用以下两种方式编译:
%%     1. PDFLaTeX
%%     2. XeLaTeX [推荐]
%%  注意：
%% {}   1. 在改变编译方式前应先删除 *.toc 和 *.aux 文件，
%%       因为不同编译方式{}产生的辅助文件格式可能并不相同。

%%\documentclass{cumcmart}
\documentclass[nocover]{cumcmart}
%切换到无封面的版本，有些赛区不允许前面的承诺页用pdf格式，可以用此选项去掉。
\usepackage[all]{xy}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{bm}
\usepackage{framed}
\begin{document}

\section{测试文档}

这部分需要假设淹没的地表面积越小，对生态的影响一般来说越小
落差是drop还是throw，我后面用的是throw，不一定对

$V$ the volume of reservoir \\
$S$ the water surface area of reservoir \\
$H$ the water depth of reservoir \\
$\alpha$ the bank angle（倾斜角）of slope
$g$ the gravitational acceleration \\


\section{Search for possible reaches to build dams}
To build new dams, we need to find a serial of possible reaches at first. In accordance with the norms, the choice of reaches should take geology, terrain, economic, ecology, disaster and so forth factors into consideration. However, the major determinant of a dams to be of valuable worthy is terrain. \\
To be specific, we get two principle of searching for possible reaches to build dams:\\
%这里可以加个格式
1. the higher the throw（落差）, the more abundant hydropower（水能）resources is contained; \\
2. In consideration of reducing ecological effects as much as possible and reducing the evaporation loss （蒸发损失） of water, the surface area （水面面积） of artificial reservoirs should be small under certain requirement of volume. To build reservoir with small surface area and certain volume, the average depth of reservoir should be deep, thus, dams should be built between deep ravines\\

%对第一条原则的解释
Hydropower station convert gravitational potential energy of water into electrical energy. The gravitational potential energy is calculated as $E_{p} = mgh$, thus, higher throw implies bigger electricity-generation capacity.


%对第二条原则的解释，这前面加个转折？现在这里的文字有些生硬
To simplify model, we assume that the vertical section（纵向截面） of a reservoir is a approximate trapezoid, then the submerged area can be expressed as below:
\begin{equation}\int_{A}^{B}\frac{H\left(l\right)}{\sin\left[\alpha\left(l\right)\right]}dl + \int_{C}^{D}\frac{H\left(L\right)}{\sin\left[\alpha\left(L\right)\right]}dL + S_{bottom}\end{equation}
where $l, L$ are the lengths of left bank and right bank respective; $A, B$ indicate the starting position and end position of $l$; similarly, $C, D$ indicate the starting position and end position of $L$.
The expression $\left(1\right)$ is still hard to deal, because of the difficulty of the estimation of $\alpha$. In order to make our assessment feasible, we need to simplify the expression $\left(1\right)$. Noticed that:
\begin{equation}
\int_{A}^{B}\frac{H\left(l\right)}{\sin\left[\alpha\left(l\right)\right]}dl = \frac{1}{sin\left[\alpha\left(\zeta\right)\right]}\int_{A}^{B}H\left(l\right)dl
= KH_{average}l
\end{equation}
where $K$ is a coefficient of inclination. expressions $\left(2\right)$ is a application of mean value theorem for integrals, it fits in with the physics intuition. Then, the submerged area can be estimated as:
\begin{equation}
\left(K_{1}l + K_{2}L\right)H_{average} + S_{bottom}
\end{equation}
Using expression $\left(3\right)$, we can qualitatively explain why small surface area is desired. Using equation $H_{average} = \frac{V}{S}$, we get:
\[S_{submerged} \approx \left(K_{1}l + K_{2}L\right)\frac{V}{S} + S_{bottom}\]
and using the assumption of vertical section, the area of the bottom of a reservoir can be estimated as:
\begin{equation}
S_{bottom} = \int\left(\beta dS \right) \propto S
\end{equation}
where $\beta$ is a coefficient of position and water factors, the expression $\left(4\right)$ qualitatively explain that $S_{bottom}$ is proportional to $S$, thus we get:
\begin{equation}
S_{submerged} \approx \left(K_{1}l + K_{2}L\right)\frac{V}{S} + CS
\end{equation}
where $C$ is a coefficient to indicate that $S_{bottom}$ is proportional to $S$\\
Since the right side of the expression $\left(5\right)$ is a hyperbolic function and it monotonically decrease when $S \geq \sqrt{\frac{\left(K_{1}l + K_{2}L\right)V}{C}}$. In the actual situation, $S \gg \sqrt{V}$, so we can qualitatively conclude that under certain requirement of volume small surface area of reservoir is more beneficial than the bigger surface area.

According to the above discussion, we should find the reaches（河段）with big throws on the Zambezi river based on the first principle. In accordance with the second principle, the possible reaches should between deep ravines （深谷）, because a reservoir in deep ravines can have deeper water depth and thus smaller surface area.

上面是第一部分

To assume the volume of a reservoir, a slightly different method can be used. The accurate data of vertical section is hard to get directly（我这里想表示等高线信息比纵截面信息容易获得）. So we consider to use isohypse data to calculate volume. Local isohypse （等高线）information can be gotten using GIS software \textbf{Global Mapper}. The volume can be expressed as below:
\begin{equation}\int_{0}^{H_{max}}\frac{1}{2}\left[S\left(H\right) + S\left(H + dH\right)\right]dH\end{equation}
where $H_{max}$ indicates the max water depth, $S\left(H\right)$ expresses the surface area enclosed by isohypse of same altitude. According to our above assumptions of vertical section, $S\left(H + dH\right)$ can be assumed as $S\left(0\right) + \frac{H}{2\tan\left(\alpha\right)}$. Then, the expression $\left(2\right)$ can be rewritten as:
\begin{equation}\int_{0}^{H_{average}}\left(S(0) + \frac{H}{\tan\left(\alpha\right)}\right)dH\end{equation}
We need to emphasize that $S$ in the $\left(3\right)$ is equivalent surface area not actual surface area, to use actual surface area calculated using isohypse data, rewrite $\left(3\right)$ as:
\begin{equation}\int_{0}^{H_{average}}\left(S - \frac{H}{\tan\left(\alpha\right)}\right)dH
\end{equation}
where $S$ of certain altitude and location can be calculated using isohypse data.

\newpage

\subsection{水坝的建设成本}
%% 水电站成本计算
水电站的建设成本可以从工程的角度出发进行估计，其中包含了前期的可行性报告编制费用、整个工程项目的设计费用、项目的整体建造成本、项目后期的可行性分析报告。

其中首先计算建造费用，和电站的规模直接相关，根据Hydro Review Maga给出的水坝建造成本公式
\begin{equation}
C_{build} = K(\frac{V_{cap}}{(H/\Delta)^{\eta}})^{\gamma}
\end{equation}
其中的$V_{cap}$为装机容量，H为水头高度，$\Delta$和$\eta$为调节因子，用于水头高度和装机容量之间的关联，同时调整水头高度的影响因子。$\gamma$为成本因子，K 为成本系数，根据水坝的大小进行适当的取值，比如大型的取值可以为$7.7\times10^4$，小型的水坝取值可以为$5.0 \times 10^4$。

其中装机容量$V$可由上述的需要通过计算年流量得到，而年流量包含三个方面河流流量、水库的蒸发量、降雨量
\begin{equation}
V_{total} = V_{flow} - V_{evap} + V_{rain} = V_{flow} - (1-{\alpha})v_{0}S({\mu}T_{aver})^{\theta}t + {\beta}v_{1}St
\end{equation}
其中$v_{0}$为单位时间内单位面积湖水蒸发水量，$\alpha$为蒸发回流系数，$\mu$为温度调节系数，$\theta$为温度条件因子，$\beta$为流入水库系数比例，$v_{1}$为单位时间单位面积全年平均降雨量，$S$为河流面积，$t$为时间。

其中$S$可由下面的计算公式求得：
\begin{equation}
S \approx \left(K_{1}l + K_{2}L\right)\frac{V}{S} + CS
\end{equation}

由上面的两式，我们可以获得装机容量的最终计算公式：
\begin{equation}
V_{cap} = {\rho}gV_{total}H = {\rho}g(V_{flow} - (1 - {\alpha})v_{0}S({\mu}T_{aver})^{\theta}t + {\beta}v_{1}St)H
\end{equation}

接着我们考虑水坝建造过程中的设计费用，设计费用和建造费用之间存在一定的比例关系，我们可以直接获得
\begin{equation}
C_{design} = {\delta}(C_{build})^{\tau}
\end{equation}
这里的$\delta$为比例系数，$\tau$为比例指数，一般而言，根据统计数据，$\tau$一般取为0.9，而$\delta$一般取为0.34

接着我们考虑工程中其它成本，根据通用惯例，工程开始时需要进行可行性分析，包括地质勘测；工程结束之后需要撰写相应的可行性分析报告、使用综合各报告、项目总结。根据世界银行给出的统计数据，后期可行性分析报告和使用综合报告费用约为设计费用的$10\%$，前期可行性分析报告约为设计费用的$2\%$。
因此有
\begin{equation}
C_{prev} + C_{later}= (\alpha_{1} + \alpha_{2})C_{design} = 0.12C_{design}
\end{equation}
由此，我们得到整个工程建设成本为：
\begin{equation}
C_{project} = C_{build} + C_{design} + C_{prev} + C_{later}
\end{equation}
\begin{equation}
C_{project} = K(\frac{V_{cap}}{(H/\Delta)^{\eta}})^{\gamma} + (1+\alpha_{1}+\alpha_{2}){\delta}(K(\frac{V_{cap}}{(H/\Delta)^{\eta}})^{\gamma})^{\tau}
\end{equation}

\subsection{候选点初步计算}
由上面的模型A我们得到了初步的候选水坝建造区域，但是作为连续的区域，建立评价函数来对其一一计算工作量很大并且实际使用价值低。因此，我们从候选区域中将候选点找出，将连续问题转变为离散的问题，降低问题的复杂程度。

从上面的分析中，我们获知了选择水坝地址时需要考虑的重要因素：水位落差，岩层土壤的适宜程度，两岸山体的倾斜程度，两岸山体的高度，河流的宽度。由于存在如此多的考虑因素，我们决定使用层次分析法(Analytic Hierarchy Process, AHP)对其进行分析。

% 此处需要一个示意图，表示河流
我们首先沿着河流流动方向建立自然坐标系，假定$l$为距离区域初始点的距离。用$F_{l}$表示距离初始点的水位落差，$\alpha_{l}$表示$l$点处的山势倾斜程度，$H_{l}$表示$l$处的山体高度，$W_{l}$表示$l$处的河流宽度，$C_{l}$表示山体岩层和土壤的适宜程度。

同时，我们采用1-9尺度作为AHP的中的比较尺度
\begin{table}[!ht]
\centering
  \begin{tabular}{cc}
  \hline
   Intensity of Importance & meaning  \\
  \hline
  $1$ & Equal importance \\
  $3$ & Moderate importance \\
  $5$ & Strong importance \\
  $7$ & Very strong or demonstrated importance \\
  $9$ & Extreme importance \\
  $2,4,6,8$ & Intensity between two hierarchies \\
  $1,1/2,...,1/9$ & The opposite numbers\\
  \hline
  \end{tabular}
  \caption{Intensity of Importance}
\end{table}

我们令影响因素组合成一个层次因素向量$\textbf{P}_1$，并有$\textbf{P}_1 = (F_{l}, \alpha_{l}, H_{l}, C_{l}, W_{l})$，则可以得到比较矩阵$\textbf{A}_1$，且满足以下式子：
\begin{equation}
\textbf{A}_1 = (a_{i,j})_{5\times5},\qquad a_{ij} > 0, \quad a_{ij} = \frac{1}{a_{ji}}
\end{equation}

此时需要得到的是各因素的重要程度，也即权向量$\textbf{w}$。

%下面是一段口胡
对于上述的5种因素，$C_{l}$和$W_{l}$直接影响到工程是否可行，所以最为重要。但是由于$W_{l}$相对于$C_{l}$更有选择的弹性，所以在此处进行选点时$W_{l}$是更有效的评判因素。在其他的三个因素中，$F_{l}$和$H_{l}$影响了水坝的蓄水能力，所以也十分重要，而$\alpha_{l}$主要影响淹没面积，是相对重要性较低的因素。

依据上述的讨论，我们估计了问题的成对比较矩阵:

\[\textbf{A}_1 =
\left[
\begin{matrix}
1 & 5 & 1 & \frac{1}{3} & \frac{1}{4} \\
\frac{1}{5}  & 1 & \frac{1}{5} & \frac{1}{7} & \frac{1}{8} \\
1 & 5 & 1 & \frac{1}{3} & \frac{1}{4} \\
3 & 7 & 3 & 1 & \frac{1}{2} \\
4 & 8 & 4 & 2 & 1 \\
\end{matrix}
\right]
\]

计算$A_{1}$的最大特征值，为$\lambda = 5.1415$
$\textbf{A}_1$的一致性指标为
\[\mathit{CI} = \frac{\lambda - n}{n - 1} = 0.0354\]
其中，$n$为矩阵的阶数
$n = 5$时随机一致性指标\textit{RI}为$1.12$，于是$A_{1}$的一致性比率为:
\[\mathit{CR} = \frac{\mathit{CI}}{\mathit{RI}} = 0.0316 < 0.1 \]

所以，$\textbf{A}_1$的不一致程度在容许范围之内，$\lambda$对应的特征向量为$\left[0.2185, 0.063, 0.2185, 0.5190, 0.7945\right]$

根据上述计算，我们得到了权向量$\textbf{w}_{1}$的取值：
\begin{equation}
\textbf{w}_{1} = \lambda = \left[0.2185, 0.063, 0.2185, 0.5190, 0.7945\right]
\end{equation}

由此，我们得到初步的定点评价函数
\begin{equation}
E(l) = \textbf{P}\textbf{w}_{1}^{T} = 0.2185F_l + 0.063{\alpha}_{l} + 0.2185H_l + 0.519C_l + 0.7945W_l
\end{equation}

接着，我们使用评价函数来对模型A中得到的区域取点。但是评价函数使用时需要注意以下几点：
\begin{itemize}
\item 每次不能选取多个点，否则先选的点会破坏原来的$H_l$计算公式，从而使得后面的点选取出现问题。
\item 建立五个因素的函数时，需要设定相应的最大值，由于水坝建立仅仅需要满足适当条件即可，并不需要无限增大。即函数形式为
\begin{eqnarray}
F(x) =
\begin{cases}
f(x) & 0 < x < \theta \cr F_{max} & x \ge \theta
\end{cases}
\end{eqnarray}
\end{itemize}


根据以上要求，我们给出以下选点算法：
\begin{framed}
\newcounter{alg}
\begin{list}{\arabic{alg}.}
    {\usecounter{alg}\setlength{\parsep}{0ex}\setlength{\itemsep}{0ex}}
\item[] 选点算法
\item 根据候选区域建立自然坐标系，以上游起点为原点，设置评价阈值为$T_{0}$。
\item 由坐标系和数字高程模型(DEM)建立五个因素相应的函数$F(l),\alpha(l),H(l),C(l),W(l)$，并设立最大值。
\item 根据$l$增大的方向，将$l$代入评价函数$E(l)$，选择最满足条件的点作为候选点。
\item 根据得到的候选点，将区域分为两段。对于每段区域重复上述2、3操作，直至没有新的候选点产生。
\item 将得到的所有点作为候选点放入候选集合。
\end{list}
\end{framed}

\subsection{收益分析}
从上面的分析中我们获得了水电站的装机容量$V_{cap}$，由此我们可以得到水坝一年发电的收益。
\begin{equation}
B_{elec} = V_{cap}T_{use}p_{elec}
\end{equation}
其中$T_{use}$为年可发电时间(因为在prolonged low water period的时候需要蓄水而无法发电)，$p_{elec}$为当地的电价。通常查询数据可以得到，$T_{use}$一般在$3700-4200$h之间取值，而当前电价在$0.384-0.468$Cent/KWh

此外，水坝建造带来的附加收入还有渔业收入、娱乐收益、灌溉收益等
渔业收入的计算可以依照Welcomme在River fisheries中建立的模型给出：
\begin{equation}
B_{fish} = {\gamma}S^{\theta}P_{fish}
\end{equation}
$\gamma$为流域面积与产量之间的关系系数，根据论文中数据取值为0.03，S为河流的面积，$\theta$为流域面积与产量之间的关系指数，根据论文，非洲地区取值一般为0.97。
$p_{fish}$为鱼类平均价格，由鱼的种类和品质确定，查询得到2016年数据为3.5 Dollar per Kilogram。
此外，还有一些无法量化的收益，如周边植被和粮食的灌溉、对洪水的防治和抵御、可依托大坝修建的娱乐设施并由此带来的娱乐收入。
% 参考文献中写上这篇论文
Welcomme, R.L., 1985. River fisheries. FAO Fish. Tech. Pap. No. 262, Rome

我们由此得到水坝建造的收益计算公式：
\begin{equation}
B_{total} = B_{elec} + B_{fish} + B_{other}
\end{equation}
其中$B_{other}$为其他方面收益的一个基本估计，其中包含灌溉、洪水防治等，具体数值可以参照Zambezi River下游的其他水坝
\subsection{安全性}
因为是确定选址的安全性，因此我们在考虑问题时不分析运行维护时候的安全性，而是考虑选取位置下地形和地质条件对安全性的影响。所以这里直接采用了上面得到的评估函数作为安全性的度量。
\begin{equation}
S_{i} = E_{l,i}
\end{equation}

\subsection{其他因素}
同时，水坝建设时对周围人、环境的影响因素，也应该作为一个计量因素放入我们的评估函数中。其中比较突出的几项为对周围生活的居民的影响(移民)，对周围动植物生存空间的侵占等。
\begin{equation}
F_{other} = P_{i}({\xi}S^{\sigma})m_{0} + S_{submerge}(\beta_{1}m_{1} + \beta_{2}m_{2}) + F_{balance}
\end{equation}
其中$P_{i}$为某区域第$i$个水坝周围的人口密度，${\xi}S^{\sigma}$为受水坝影响的周围居民的数量估算公式，$S$为水库面积，$m_{0}$为人均移民成本。$S_{submerge}$为水坝淹没的陆地面积（计算公式可以参照上面的计算公式），$\beta_{1},\beta_{2}$为动物和植物的影响调节系数，$m_{1},m_{2}$为单位面积上动物、植物对生态的价值。此外还有一个$F_{balance}$用于均衡$F_{other}$的常量。


\subsection{综合}
上面，我们得到了成本、安全性、收益、其他因素的量化指标，在最终的评估函数中，我们需要给出这些因素所占的权重。此处，我们依旧使用AHP方法来对其中各个因素所占比例进行计算。

将上述的四种因素组合为影响因素向量$\textbf{P}_2$，其中$\textbf{P}_2 = (C_{project}, S_{i}, B_{total}, F_{other})$，由此，我们可以设置比较矩阵$\textbf{A}_2$，满足以下式子：

\[\textbf{A}_2 = (a_{i,j})_{4\times4}, \qquad a_{i,j}>0, \qquad a_{i,j} = \frac{1}{a_{j,i}}\]
同理，采用1-9尺度作为衡量标准。一般而言，水坝选址时安全性和成本是最为重要的两个因素，而收益在这里并非特别重要，而且收益不应该是我们最终优化的目标，其他因素的影响相较于收益影响更高，但是相对于成本、安全性则次之。
依据讨论，我们估计了成对比较矩阵的值：

\[\textbf{A}_2 =
\left[
\begin{matrix}
1 & 1 & 2 & 2 \\
1 & 1 & 3 & 2 \\
\frac{1}{2}& \frac{1}{3} & 1 & 1 \\
\frac{1}{2} & \frac{1}{2} & 1 & 1 \\
\end{matrix}
\right]
\]

计算$A_{2}$的最大特征值，为$\lambda = 4.0206$
$\textbf{A}_2$的一致性指标为
\[\mathit{CI} = \frac{\lambda - n}{n - 1} = 0.0069\]

其中，$n$为矩阵的阶数
$n = 4$时随机一致性指标\textit{RI}为$0.90$，于是$A_{2}$的一致性比率为:
\[\mathit{CR} = \frac{\mathit{CI}}{\mathit{RI}} = 0.0076 < 0.1 \]

所以，$\textbf{A}_2$的不一致程度在容许范围之内，$\lambda$对应的特征向量为$\left[0.6092, 0.6780, 0.2765, 0.3046\right]$

根据上述计算，我们得到了权向量$\textbf{w}_{2}$的取值：
\begin{equation}
\textbf{w}_{2} = \lambda = \left[0.6092, 0.6780, 0.2765, 0.3046\right]
\end{equation}

由此，我们评价函数为$V(i)$的表达形式：
\begin{equation}
V(i) = 0.2185C(i) + 0.678S(i) + 0.2675B(i) + 0.3046F(i)
\end{equation}


% 参考网站：http://www.zaraho.org.zm/hydrology/river-flows
% 参考网站：https://en.wikipedia.org/wiki/Zambezi
可能的参数取值：
\begin{table}[!ht]
\centering
  \begin{tabular}{ccc}
  \hline
  Symbols & Values & Units \\
  \hline
  $K$ & $6.3\times10^4$ & $1/m^{4}kw^{0.82}$ \\
  $\Delta$ & 0.3 & / \\
  $\eta$ & 0.3 & / \\
  $\gamma$ & 0.82 & / \\
  $\alpha$ & 0.14 & / \\
  $V_{flow}$ & $1.213\times10^{10}$ & $m^3/year$ \\
  $v_0$ & 1950 & $mm/year$\\
  $v_1$ & 1250  & $mm/year$\\
  $\mu$ & 0.03 & $K^-1$\\
  $\theta$ & 0.5 & / \\
  $\beta$ & 0.85 & / \\
  $\rho$ & $1.01\times10^3$ & $kg/m^3$\\
  $g$ & 9.8 & $m/s^2$\\
  $\delta$ & 0.34 & / \\
  $\tau$ & 0.9 & / \\
  $T_{use}$ & 3950 & h \\
  $p_{elec}$ & 14.2 & $cents/kwh$ \\
  $p_{fish}$ & 3.5 & $dollars/kg$ \\
  $B_{other}$ & $3.7\times10^5$ & $dollars$ \\
  $P_{i}$ & 20.2 & $Persons/km^2$\\
  $\xi$ & 0.042 & / \\
  $\sigma$ & 0.5 & / \\
  $F_{balance}$ & $2.3\times10^6$ & $dollars$ \\
  \hline
  \end{tabular}
\end{table}



\end{document}
